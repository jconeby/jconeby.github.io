

# Pentesting Active Directory with PowerShell

It is important to understand that PowerShell is just a tool, and it can be used to perform evil just as easily as for good.  Increasingly, sophisticated threat actors are "Living off the LAN" and using tools to perform malicious actions that are already present on a target system.  This makes their activity less likely to be caught and can helps prevent attribution.

<br>

#####What makes PowerShell an ideal attack platform?

- It runs code in memory without touching disk

- It can download and execute code from another system

- Interfaces with the .NET framework and Windows APIs

- Most organizations are not watching PowerShell activity

- CMD.exe is usually blocked, but not PowerShell

<br>

###PowerView

- An amazing PowerShell recon tool that will allow attackers to gain network situational awareness on a Windows domain
    - https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1

<br>

#### PowerView Commands for AD Recon

- **Get-DomainUser**: Retrieves a list of users in the domain
  
- **Get-DomainGroup**: Gets a list of groups in the domain
  
- **Get-DomainObject**: Returns all domain objects from Active Directory

- **Get-NetSession**: Gets session info from a remote machine

- **Get-DomainGPO**: Returns all GPOs or specific GPO objects in Active Directory
  
- **Get-Forest**: Returns the forest object of the current forest

- **Get-DomainOU**: Searches for all the organizational units (OUs) within Active Directory

- **Find-DomainUserLocation**: Finds domain machines where specific users are logged into


